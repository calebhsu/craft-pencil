<craft name="pencil">
    <parameter name="length" type="int" default="75"/>
    
    <col layout="centerZ()">
        <stack transform="rotateX(270)">
            <cylinder radius="2.2" height="3" color="indianred"/>
            <repeat n="3" color="silver">
                <cylinder radius="2.2" height="1"/>
                <cylinder radius="2.3" height="2"/>
            </repeat>
        </stack>
        
        <g transform="rotateX(180)" color="orange">
            <script>
                function main() {
                    // Shaft
                    var length = params.length;
    
                    var p;
                    
                    // handles minimum length
                    if (length < 4)
                        length = 4;
                    
                    // rounds off tip 
                    p = difference(
                        shaft(),
                        tip_round()
                    );
        
                    // assembled pencil
                    return p;
        
                    // pencil components
                    function shaft() {
                        var s;
        
                        // parts
                        s = cylinder({
                            r: 2,
                            h: length,
                            fn: 6
                        })
                        
                        // transformations
                        s = s.rotateX(90);
                        s = s.translate([0, 25, 0]);
        
                        return s;
                    }
        
                    function tip_round() {
                        var r;
    
                        // parts
                        r = torus({
                            ri: 5, 
                            ro: 6, 
                            fni: 6
                        });
                        
                        // transformations    
                        r = r.rotateX(90);
                        r = r.translate([0, -length + 25, 0]);
                      
                        return r;
                    }
                }
            </script>
        </g>
        
        <solidify color="black">
            <col spacing="-2" layout="centerZ()">
                <circle radius="0.1" transform="rotateX(90)"/>
                <circle radius="1" transform="rotateX(90)"/>
            </col>
        </solidify>
    </col>
    
</craft>